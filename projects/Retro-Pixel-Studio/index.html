<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>Retro Pixel Studio Pro - Ultimate Edition</title>
	<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
	<base target="_blank">
	<base target="_blank">
</head>

<body class="light-mode">

	<div id="app-layout">
		<header>
			<div class="brand-title">Retro Pixel Studio <span style="font-size:8px; vertical-align:super;">PRO</span></div>
			<div class="d-flex gap-2">
				<button class="btn btn-retro btn-action-header" onclick="App.UI.openHelp()" title="Help"><i class="bi bi-question-circle"></i></button>
				<button class="btn btn-retro btn-action-header" onclick="App.UI.openExport()" title="Export Image"><i class="bi bi-upload"></i></button>
				<button class="btn btn-retro btn-action-header" onclick="document.getElementById('fileInput').click()" title="Load Image"><i class="bi bi-download"></i></button>
				<button class="btn btn-retro btn-action-header" onclick="App.UI.openNewDoc()" title="New"><i class="bi bi-file-earmark"></i></button>
				<button class="btn btn-retro btn-action-header" onclick="App.UI.toggleTheme()" title="Theme"><i class="bi bi-sun-fill" id="theme-icon"></i></button>
				<button class="btn btn-retro btn-action-header" onclick="App.UI.toggleFullscreen()" title="Fullscreen"><i class="bi bi-arrows-fullscreen"></i></button>
			</div>
			<input type="file" id="fileInput" accept="image/*,.gif" style="display:none" onchange="App.IO.handleImport(this)">
		</header>

		<div id="workspace">
			<aside>
				<div class="panel-section">
					<label class="panel-label">Tools</label>
					<div class="tool-row">
						<button class="btn btn-retro tool-btn active" id="tool-pencil" onclick="App.Tools.set('pencil')"><i class="bi bi-pencil"></i> Pencil</button>
						<button class="btn btn-retro tool-btn" id="tool-eraser" onclick="App.Tools.set('eraser')"><i class="bi bi-eraser"></i> Eraser</button>
						<button class="btn btn-retro tool-btn" id="tool-line" onclick="App.Tools.set('line')"><i class="bi bi-slash-lg"></i> Line</button>
						<button class="btn btn-retro tool-btn" id="tool-rect" onclick="App.Tools.set('rect')"><i class="bi bi-square"></i> Box</button>
						<button class="btn btn-retro tool-btn" id="tool-circle" onclick="App.Tools.set('circle')"><i class="bi bi-circle"></i> Circle</button>
						<button class="btn btn-retro tool-btn" id="tool-fill" onclick="App.Tools.set('fill')"><i class="bi bi-paint-bucket"></i> Fill</button>
						<button class="btn btn-retro tool-btn" id="tool-select" onclick="App.Tools.set('select')"><i class="bi bi-bounding-box"></i> Select</button>
						<button class="btn btn-retro tool-btn" id="tool-picker" onclick="App.Tools.set('picker')"><i class="bi bi-eyedropper"></i> Pick</button>
					</div>
				</div>

				<div class="panel-section">
					<label class="panel-label">History</label>
					<div class="d-flex gap-2">
						<button class="btn btn-retro" onclick="App.History.undo()" style="width:50%;"><i class="bi bi-arrow-counterclockwise"></i> Undo</button>
						<button class="btn btn-retro" onclick="App.History.redo()" style="width:50%;"><i class="bi bi-arrow-clockwise"></i> Redo</button>
					</div>
				</div>

				<div class="panel-section">
					<label class="panel-label">Edit</label>
					<button class="btn btn-retro" onclick="App.Actions.copy()" id="btn-copy"><i class="bi bi-clipboard"></i> Copy</button>
					<button class="btn btn-retro" onclick="App.Actions.paste()" id="btn-paste"><i class="bi bi-clipboard-check"></i> Paste</button>
					<button class="btn btn-retro" onclick="App.Actions.cut()" id="btn-cut"><i class="bi bi-scissors"></i> Cut</button>
					<button class="btn btn-retro" onclick="App.Actions.deleteSelection()" id="btn-delete" style="display:none;"><i class="bi bi-trash"></i> Delete</button>
					<button class="btn btn-retro" onclick="App.Actions.flip('h')">Flip H</button>
					<button class="btn btn-retro" onclick="App.Actions.flip('v')">Flip V</button>
					<button class="btn btn-retro" onclick="App.Actions.rotate(90)">Rotate 90Â°</button>
					<button class="btn btn-retro" onclick="App.Actions.invert()">Invert</button>
					<button class="btn btn-retro btn-danger" onclick="App.Actions.clear()"><i class="bi bi-trash-fill"></i> Clear All</button>
					<button class="btn btn-retro" onclick="App.Actions.convertToPalette()" style="background:#ff6b6b;"><i class="bi bi-palette"></i> To Palette</button>
				</div>

				<div class="panel-section">
					<label class="panel-label">Canvas</label>
					<div class="control-row">
						<span>Size:</span>
						<select class="form-select" style="width: 120px;" onchange="App.Canvas.resize(this.value)">
							<option value="8">8x8</option>
							<option value="16">16x16</option>
							<option value="24">24x24</option>
							<option value="32">32x32</option>
							<option value="48">48x48</option>
							<option value="64" selected>64x64</option>
							<option value="96">96x96</option>
							<option value="128">128x128</option>
						</select>
					</div>
					<div class="control-row">
						<span>Zoom:</span>
						<select class="form-select" style="width: 120px;" onchange="App.Canvas.zoom(this.value)">
							<option value="4">4x</option>
							<option value="8">8x</option>
							<option value="10" selected>10x</option>
							<option value="12">12x</option>
							<option value="16">16x</option>
							<option value="20">20x</option>
							<option value="24">24x</option>
							<option value="32">32x</option>
						</select>
					</div>
					<div class="control-row">
						<label><input type="checkbox" id="check-grid" checked onchange="App.UI.toggleGrid()"> Grid</label>
						<label><input type="checkbox" id="check-crt" onchange="App.UI.toggleCRT()"> CRT</label>
					</div>
				</div>
			</aside>

			<section id="canvas-viewport">
				<div id="canvas-stack">
					<canvas id="main-canvas" width="64" height="64"></canvas>
					<canvas id="grid-canvas" width="640" height="640"></canvas>
					<div id="selection-box"></div>
					<div id="scanlines" style="display:none;"></div>
				</div>
			</section>

			<aside class="right-panel">
				<div class="panel-section" style="text-align:center;">
					<label class="panel-label">Preview</label>
					<div class="preview-mini">
						<canvas id="preview-canvas" width="64" height="64" style="width:100%; height:100%;"></canvas>
					</div>
					<div class="control-row" style="font-size:14px; color:var(--c64-text);">
						<span id="pos-display">0,0</span>
						<span id="size-display">64x64</span>
					</div>
				</div>

				<div class="panel-section" style="flex:1; display:flex; flex-direction:column; overflow:hidden;">
					<label class="panel-label">Palette</label>
					<select id="palette-select" class="form-select mb-2" onchange="App.Palette.load(this.value)"></select>
					<div style="flex:1; overflow-y:auto;">
						<div id="palette-grid" class="palette-grid"></div>
					</div>
					<div id="palette-info" class="palette-info"></div>
				</div>

				<div class="panel-section">
					<label class="panel-label">Transparency</label>
					<div class="control-row">
						<input type="checkbox" id="use-trans" onchange="App.State.transEnabled = this.checked">
						<label for="use-trans">Enable</label>
					</div>
					<label style="font-size:12px;">Target:</label>
					<div id="trans-helper" onclick="App.Palette.setTransColor()"></div>
				</div>
			</aside>

		</div>

		<footer>
			<span style="font-family:'Press Start 2P'; font-size:10px; color:var(--c64-text);"><span class="status-indicator"></span>STATUS: READY</span>
			<span id="footer-text" style="font-family:'Press Start 2P'; font-size:8px;"></span>
		</footer>
	</div>

	<div id="export-modal" class="modal-overlay">
		<div class="modal-box">
			<div class="modal-title">EXPORT IMAGE</div>
			<select id="export-fmt" class="form-select mb-2">
				<option value="image/png">PNG (Transparent)</option>
				<option value="image/jpeg">JPEG (Standard)</option>
				<option value="image/webp">WEBP (Modern)</option>
				<option value="image/bmp">BMP (Bitmap)</option>
			</select>
			<div class="d-flex gap-2 mt-1">
				<button class="btn btn-retro" onclick="App.IO.export()">Download</button>
				<button class="btn btn-retro" onclick="App.UI.closeModal('export-modal')" style="background:#888;">Cancel</button>
			</div>
		</div>
	</div>

	<div id="newdoc-modal" class="modal-overlay">
		<div class="modal-box">
			<div class="modal-title">NEW DOCUMENT</div>
			<div class="control-row mb-2">
				<span>Size:</span>
				<select id="newdoc-size" class="form-select" style="width: 120px;">
					<option value="8">8x8</option>
					<option value="16">16x16</option>
					<option value="32">32x32</option>
					<option value="64" selected>64x64</option>
					<option value="128">128x128</option>
				</select>
			</div>
			<div class="d-flex gap-2 mt-1">
				<button class="btn btn-retro" onclick="App.Actions.createNewDoc()" style="background:#28a745;">Create</button>
				<button class="btn btn-retro" onclick="App.UI.closeModal('newdoc-modal')" style="background:#888;">Cancel</button>
			</div>
		</div>
	</div>

	<div id="clear-modal" class="modal-overlay">
		<div class="modal-box">
			<div class="modal-title">CLEAR CANVAS</div>
			<p style="font-family:'VT323', monospace; font-size:18px; margin:15px 0;">Are you sure you want to clear the entire canvas?</p>
			<div class="d-flex gap-2 mt-1">
				<button class="btn btn-retro btn-danger" onclick="App.Actions.confirmClear()">Clear</button>
				<button class="btn btn-retro" onclick="App.UI.closeModal('clear-modal')" style="background:#888;">Cancel</button>
			</div>
		</div>
	</div>

	<div id="help-modal" class="modal-overlay">
		<div class="modal-box help-modal">
			<div class="modal-title">HELP & COMMANDS</div>
			<div class="help-content">
				<div class="help-section">
					<div class="help-title">Tools Shortcuts</div>
					<div class="help-item"><span>Pencil</span><span class="help-key">B</span></div>
					<div class="help-item"><span>Eraser</span><span class="help-key">E</span></div>
					<div class="help-item"><span>Line</span><span class="help-key">L</span></div>
					<div class="help-item"><span>Box</span><span class="help-key">R</span></div>
					<div class="help-item"><span>Circle</span><span class="help-key">C</span></div>
					<div class="help-item"><span>Fill</span><span class="help-key">F</span></div>
					<div class="help-item"><span>Select</span><span class="help-key">M</span></div>
					<div class="help-item"><span>Color Picker</span><span class="help-key">I</span></div>
				</div>

				<div class="help-section">
					<div class="help-title">Edit Commands</div>
					<div class="help-item"><span>Undo</span><span class="help-key">Ctrl+Z</span></div>
					<div class="help-item"><span>Redo</span><span class="help-key">Ctrl+Y</span></div>
					<div class="help-item"><span>Copy</span><span class="help-key">Ctrl+C</span></div>
					<div class="help-item"><span>Paste</span><span class="help-key">Ctrl+V</span></div>
					<div class="help-item"><span>Cut</span><span class="help-key">Ctrl+X</span></div>
					<div class="help-item"><span>Delete Selection</span><span class="help-key">Delete</span></div>
				</div>

				<div class="help-section">
					<div class="help-title">Mouse Controls</div>
					<div class="help-item"><span>Left Click</span><span class="help-key">Draw</span></div>
					<div class="help-item"><span>Right Click</span><span class="help-key">Erase</span></div>
					<div class="help-item"><span>Drag</span><span class="help-key">Shape/Select</span></div>
				</div>
			</div>
			<div class="social-links">
				<a href="https://codepen.io/H-L-the-lessful" target="_blank" class="social-link" title="CodePen"><i class="bi bi-box-seam"></i></a>
				<a href="https://www.youtube.com/@Heingel-o4z" target="_blank" class="social-link" title="YouTube"><i class="bi bi-youtube"></i></a>
			</div>
			<div class="d-flex gap-2 mt-2">
				<button class="btn btn-retro" onclick="App.UI.closeModal('help-modal')" style="background:#888;width:100%;">Close</button>
			</div>
		</div>
	</div>

	<div id="toast" class="toast"></div>

</body>
<script src="app.js"></script>
</html>
</body>
</html>