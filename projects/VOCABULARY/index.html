<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocabulary Builder Tool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <style>
        :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --secondary: #10b981;
            --light: #f8fafc;
            --dark: #1e293b;
            --gray: #64748b;
            --gray-light: #e2e8f0;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --radius: 10px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--gray);
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background-color: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
        }

        .card-title {
            font-size: 1.5rem;
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--gray);
        }

        .btn-secondary:hover {
            background-color: #475569;
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-success:hover {
            background-color: #0da271;
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: white;
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .word-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .word-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--gray-light);
            transition: all 0.2s;
        }

        .word-item:hover {
            background-color: #f8fafc;
        }

        .word-item:last-child {
            border-bottom: none;
        }

        .word-info h4 {
            font-size: 1.2rem;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .word-info p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .word-actions {
            display: flex;
            gap: 10px;
        }

        .word-actions button {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--gray);
            font-size: 1rem;
            transition: all 0.2s;
        }

        .word-actions button:hover {
            color: var(--primary);
        }

        .quiz-container {
            display: none;
        }

        .quiz-question {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: var(--dark);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .quiz-option {
            padding: 15px;
            border: 2px solid var(--gray-light);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            background-color: rgba(79, 70, 229, 0.05);
        }

        .quiz-option.selected {
            border-color: var(--primary);
            background-color: rgba(79, 70, 229, 0.1);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background-color: rgba(16, 185, 129, 0.1);
        }

        .quiz-option.incorrect {
            border-color: var(--danger);
            background-color: rgba(239, 68, 68, 0.1);
        }

        .quiz-result {
            text-align: center;
            padding: 30px;
            background-color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: none;
        }

        .result-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .result-icon.success {
            color: var(--success);
        }

        .result-icon.warning {
            color: var(--warning);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid var(--gray-light);
            padding-bottom: 10px;
        }

        .tab {
            padding: 10px 20px;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 500;
            color: var(--gray);
            cursor: pointer;
            border-radius: var(--radius) var(--radius) 0 0;
            transition: all 0.2s;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            position: relative;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -11px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
            border-radius: 3px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--gray-light);
        }

        .progress-bar {
            height: 10px;
            background-color: var(--gray-light);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            width: 0%;
            transition: width 0.5s ease-in-out;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 8px;
        }

        .difficulty-beginner {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .difficulty-intermediate {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .difficulty-advanced {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--gray);
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-book-open"></i> Vocabulary Builder</h1>
            <p class="subtitle">Expand your vocabulary with this interactive tool. Add words, practice with quizzes, and track your progress.</p>
        </header>

        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-value" id="total-words">0</div>
                <div class="stat-label">Total Words</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="mastered-words">0</div>
                <div class="stat-label">Mastered</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="quiz-score">0%</div>
                <div class="stat-label">Quiz Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="streak-days">0</div>
                <div class="stat-label">Day Streak</div>
            </div>
        </div>

        <div class="main-content">
            <div class="left-column">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-plus-circle"></i> Add New Word</h2>
                    <form id="add-word-form">
                        <div class="form-group">
                            <label for="word">Word</label>
                            <input type="text" id="word" placeholder="Enter a word" required>
                        </div>
                        <div class="form-group">
                            <label for="definition">Definition</label>
                            <textarea id="definition" rows="3" placeholder="Enter the definition" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="example">Example Sentence</label>
                            <textarea id="example" rows="2" placeholder="Enter an example sentence (optional)"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="difficulty">Difficulty Level</label>
                            <select id="difficulty" required>
                                <option value="beginner">Beginner</option>
                                <option value="intermediate">Intermediate</option>
                                <option value="advanced">Advanced</option>
                            </select>
                        </div>
                        <button type="submit" class="btn"><i class="fas fa-plus"></i> Add to Vocabulary</button>
                    </form>
                </div>

                <div class="card">
                    <h2 class="card-title"><i class="fas fa-chart-line"></i> Progress</h2>
                    <div class="form-group">
                        <label>Mastery Progress</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="mastery-progress"></div>
                        </div>
                        <div style="text-align: right; margin-top: 5px; font-size: 0.9rem;" id="progress-text">0%</div>
                    </div>
                    <button class="btn btn-success" id="start-quiz-btn"><i class="fas fa-play-circle"></i> Start Practice Quiz</button>
                </div>
            </div>

            <div class="right-column">
                <div class="card">
                    <div class="tabs">
                        <button class="tab active" data-tab="all-words">All Words</button>
                        <button class="tab" data-tab="favorites">Favorites</button>
                        <button class="tab" data-tab="need-practice">Need Practice</button>
                    </div>

                    <div id="all-words" class="tab-content active">
                        <h3 class="card-title"><i class="fas fa-list"></i> My Vocabulary</h3>
                        <div class="word-list" id="word-list-container">
                            <div class="empty-state" id="empty-state-all">
                                <i class="fas fa-book"></i>
                                <h3>No words added yet</h3>
                                <p>Start by adding your first vocabulary word using the form on the left.</p>
                            </div>
                        </div>
                    </div>

                    <div id="favorites" class="tab-content">
                        <h3 class="card-title"><i class="fas fa-star"></i> Favorite Words</h3>
                        <div class="word-list" id="favorites-container">
                            <div class="empty-state">
                                <i class="fas fa-star"></i>
                                <h3>No favorites yet</h3>
                                <p>Mark words as favorites to see them here.</p>
                            </div>
                        </div>
                    </div>

                    <div id="need-practice" class="tab-content">
                        <h3 class="card-title"><i class="fas fa-exclamation-circle"></i> Words to Practice</h3>
                        <div class="word-list" id="practice-container">
                            <div class="empty-state">
                                <i class="fas fa-exclamation-circle"></i>
                                <h3>No words need practice</h3>
                                <p>All your words are mastered! Add more challenging words.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="quiz-container" id="quiz-container">
                    <div class="card">
                        <h2 class="card-title"><i class="fas fa-question-circle"></i> Vocabulary Quiz</h2>
                        <div id="quiz-progress">Question 1 of 5</div>
                        <div class="quiz-question" id="quiz-question">What is the meaning of the word "ephemeral"?</div>
                        
                        <div class="quiz-options" id="quiz-options">
                            <!-- Options will be dynamically added here -->
                        </div>
                        
                        <div style="display: flex; justify-content: space-between;">
                            <button class="btn btn-secondary" id="quiz-prev-btn" style="display: none;">
                                <i class="fas fa-arrow-left"></i> Previous
                            </button>
                            <button class="btn" id="quiz-next-btn">
                                Next <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="quiz-result" id="quiz-result">
                    <div class="result-icon success">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h2>Quiz Completed!</h2>
                    <p>Your score: <span id="final-score">0</span> out of <span id="total-questions">0</span></p>
                    <div class="progress-bar" style="margin: 20px auto; max-width: 300px;">
                        <div class="progress-fill" id="quiz-result-progress"></div>
                    </div>
                    <button class="btn" id="retry-quiz-btn"><i class="fas fa-redo"></i> Try Again</button>
                    <button class="btn btn-secondary" id="close-quiz-btn"><i class="fas fa-times"></i> Close Quiz</button>
                </div>
            </div>
        </div>

        <footer>
            <p>Vocabulary Builder Tool &copy; 2026 | Made with <i class="fas fa-heart" style="color: var(--danger);"></i> for language learners</p>
            <p>All data is stored locally in your browser</p>
        </footer>
    </div>

    <script>
        // Vocabulary data and app state
        let vocabulary = JSON.parse(localStorage.getItem('vocabulary')) || [];
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let stats = JSON.parse(localStorage.getItem('stats')) || {
            totalWords: 0,
            masteredWords: 0,
            quizScore: 0,
            streakDays: 0,
            lastPracticeDate: null
        };
        
        let currentTab = 'all-words';
        let quizData = {
            active: false,
            currentQuestion: 0,
            score: 0,
            questions: [],
            userAnswers: []
        };

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            updateStats();
            renderWordLists();
            
            // Set up event listeners
            document.getElementById('add-word-form').addEventListener('submit', addNewWord);
            document.getElementById('start-quiz-btn').addEventListener('click', startQuiz);
            document.getElementById('quiz-next-btn').addEventListener('click', nextQuestion);
            document.getElementById('quiz-prev-btn').addEventListener('click', prevQuestion);
            document.getElementById('retry-quiz-btn').addEventListener('click', startQuiz);
            document.getElementById('close-quiz-btn').addEventListener('click', closeQuiz);
            
            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchTab(this.getAttribute('data-tab'));
                });
            });
            
            // Check if user practiced today
            checkStreak();
        });

        // Initialize the app
        function initializeApp() {
            // If no vocabulary data, add some sample words
            if (vocabulary.length === 0) {
                addSampleWords();
            }
        }

        // Add sample words for first-time users
        function addSampleWords() {
            const sampleWords = [
                {
                    word: "Ephemeral",
                    definition: "Lasting for a very short time",
                    example: "The beauty of cherry blossoms is ephemeral, as they bloom for only a week or two.",
                    difficulty: "intermediate",
                    mastered: false,
                    practiceCount: 0,
                    lastPracticed: null,
                    addedDate: new Date().toISOString()
                },
                {
                    word: "Ubiquitous",
                    definition: "Present, appearing, or found everywhere",
                    example: "Smartphones have become ubiquitous in modern society.",
                    difficulty: "advanced",
                    mastered: false,
                    practiceCount: 0,
                    lastPracticed: null,
                    addedDate: new Date().toISOString()
                },
                {
                    word: "Eloquent",
                    definition: "Fluent or persuasive in speaking or writing",
                    example: "Her eloquent speech moved the entire audience.",
                    difficulty: "intermediate",
                    mastered: true,
                    practiceCount: 5,
                    lastPracticed: new Date().toISOString(),
                    addedDate: new Date().toISOString()
                },
                {
                    word: "Benevolent",
                    definition: "Well meaning and kindly",
                    example: "The benevolent donor gave millions to charity.",
                    difficulty: "beginner",
                    mastered: false,
                    practiceCount: 2,
                    lastPracticed: new Date().toISOString(),
                    addedDate: new Date().toISOString()
                }
            ];
            
            vocabulary.push(...sampleWords);
            saveVocabulary();
        }

        // Add a new word to vocabulary
        function addNewWord(e) {
            e.preventDefault();
            
            const wordInput = document.getElementById('word');
            const definitionInput = document.getElementById('definition');
            const exampleInput = document.getElementById('example');
            const difficultyInput = document.getElementById('difficulty');
            
            const newWord = {
                word: wordInput.value.trim(),
                definition: definitionInput.value.trim(),
                example: exampleInput.value.trim(),
                difficulty: difficultyInput.value,
                mastered: false,
                practiceCount: 0,
                lastPracticed: null,
                addedDate: new Date().toISOString()
            };
            
            vocabulary.push(newWord);
            saveVocabulary();
            
            // Clear form
            wordInput.value = '';
            definitionInput.value = '';
            exampleInput.value = '';
            difficultyInput.value = 'beginner';
            
            // Update UI
            updateStats();
            renderWordLists();
            
            // Show success message
            showNotification('Word added successfully!', 'success');
        }

        // Save vocabulary to localStorage
        function saveVocabulary() {
            localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
            localStorage.setItem('favorites', JSON.stringify(favorites));
        }

        // Save stats to localStorage
        function saveStats() {
            localStorage.setItem('stats', JSON.stringify(stats));
        }

        // Update statistics display
        function updateStats() {
            const totalWords = vocabulary.length;
            const masteredWords = vocabulary.filter(word => word.mastered).length;
            const masteryPercentage = totalWords > 0 ? Math.round((masteredWords / totalWords) * 100) : 0;
            
            // Update stats object
            stats.totalWords = totalWords;
            stats.masteredWords = masteredWords;
            
            // Update DOM
            document.getElementById('total-words').textContent = totalWords;
            document.getElementById('mastered-words').textContent = masteredWords;
            document.getElementById('quiz-score').textContent = `${stats.quizScore}%`;
            document.getElementById('streak-days').textContent = stats.streakDays;
            
            // Update progress bar
            const progressFill = document.getElementById('mastery-progress');
            const progressText = document.getElementById('progress-text');
            progressFill.style.width = `${masteryPercentage}%`;
            progressText.textContent = `${masteryPercentage}%`;
            
            saveStats();
        }

        // Render word lists based on current tab
        function renderWordLists() {
            renderAllWords();
            renderFavorites();
            renderPracticeWords();
        }

        // Render all words
        function renderAllWords() {
            const container = document.getElementById('word-list-container');
            
            if (vocabulary.length === 0) {
                document.getElementById('empty-state-all').style.display = 'block';
                return;
            }
            
            document.getElementById('empty-state-all').style.display = 'none';
            container.innerHTML = '';
            
            vocabulary.forEach((word, index) => {
                const wordElement = createWordElement(word, index);
                container.appendChild(wordElement);
            });
        }

        // Render favorite words
        function renderFavorites() {
            const container = document.getElementById('favorites-container');
            const favoriteWords = vocabulary.filter((_, index) => favorites.includes(index));
            
            if (favoriteWords.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-star"></i>
                        <h3>No favorites yet</h3>
                        <p>Mark words as favorites to see them here.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            favoriteWords.forEach((word, arrayIndex) => {
                const index = vocabulary.findIndex(w => w.word === word.word);
                const wordElement = createWordElement(word, index);
                container.appendChild(wordElement);
            });
        }

        // Render words that need practice
        function renderPracticeWords() {
            const container = document.getElementById('practice-container');
            const practiceWords = vocabulary.filter(word => 
                !word.mastered || word.practiceCount < 3
            );
            
            if (practiceWords.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-circle"></i>
                        <h3>No words need practice</h3>
                        <p>All your words are mastered! Add more challenging words.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            practiceWords.forEach((word, arrayIndex) => {
                const index = vocabulary.findIndex(w => w.word === word.word);
                const wordElement = createWordElement(word, index);
                container.appendChild(wordElement);
            });
        }

        // Create a word element for display
        function createWordElement(word, index) {
            const wordElement = document.createElement('div');
            wordElement.className = 'word-item';
            
            const difficultyClass = `difficulty-${word.difficulty}`;
            const isFavorite = favorites.includes(index);
            
            wordElement.innerHTML = `
                <div class="word-info">
                    <h4>${word.word} ${isFavorite ? '<i class="fas fa-star" style="color: #fbbf24; font-size: 0.9rem;"></i>' : ''}</h4>
                    <p>${word.definition}</p>
                    ${word.example ? `<p style="font-style: italic; margin-top: 5px;">"${word.example}"</p>` : ''}
                    <div class="difficulty-badge ${difficultyClass}">${word.difficulty.charAt(0).toUpperCase() + word.difficulty.slice(1)}</div>
                    <div style="margin-top: 8px; font-size: 0.8rem; color: #94a3b8;">
                        <span>Practiced: ${word.practiceCount} times</span>
                        ${word.mastered ? '<span style="margin-left: 10px; color: #10b981;"><i class="fas fa-check-circle"></i> Mastered</span>' : ''}
                    </div>
                </div>
                <div class="word-actions">
                    <button class="favorite-btn" data-index="${index}" title="${isFavorite ? 'Remove from favorites' : 'Add to favorites'}">
                        <i class="${isFavorite ? 'fas' : 'far'} fa-star"></i>
                    </button>
                    <button class="master-btn" data-index="${index}" title="${word.mastered ? 'Mark as unmastered' : 'Mark as mastered'}">
                        <i class="fas ${word.mastered ? 'fa-check-circle' : 'fa-circle'}"></i>
                    </button>
                    <button class="delete-btn" data-index="${index}" title="Delete word">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            // Add event listeners to buttons
            wordElement.querySelector('.favorite-btn').addEventListener('click', toggleFavorite);
            wordElement.querySelector('.master-btn').addEventListener('click', toggleMastered);
            wordElement.querySelector('.delete-btn').addEventListener('click', deleteWord);
            
            return wordElement;
        }

        // Toggle favorite status
        function toggleFavorite(e) {
            const index = parseInt(e.currentTarget.getAttribute('data-index'));
            
            if (favorites.includes(index)) {
                favorites = favorites.filter(favIndex => favIndex !== index);
                e.currentTarget.innerHTML = '<i class="far fa-star"></i>';
                e.currentTarget.title = 'Add to favorites';
            } else {
                favorites.push(index);
                e.currentTarget.innerHTML = '<i class="fas fa-star"></i>';
                e.currentTarget.title = 'Remove from favorites';
            }
            
            saveVocabulary();
            
            // Update favorites tab if active
            if (currentTab === 'favorites') {
                renderFavorites();
            }
        }

        // Toggle mastered status
        function toggleMastered(e) {
            const index = parseInt(e.currentTarget.getAttribute('data-index'));
            vocabulary[index].mastered = !vocabulary[index].mastered;
            
            if (vocabulary[index].mastered) {
                vocabulary[index].practiceCount += 1;
                vocabulary[index].lastPracticed = new Date().toISOString();
                e.currentTarget.innerHTML = '<i class="fas fa-check-circle"></i>';
                e.currentTarget.title = 'Mark as unmastered';
                showNotification('Word marked as mastered!', 'success');
            } else {
                e.currentTarget.innerHTML = '<i class="fas fa-circle"></i>';
                e.currentTarget.title = 'Mark as mastered';
            }
            
            saveVocabulary();
            updateStats();
            
            // Update all tabs
            renderWordLists();
        }

        // Delete a word
        function deleteWord(e) {
            const index = parseInt(e.currentTarget.getAttribute('data-index'));
            
            if (confirm(`Are you sure you want to delete "${vocabulary[index].word}"?`)) {
                vocabulary.splice(index, 1);
                
                // Update favorites indices
                favorites = favorites
                    .filter(favIndex => favIndex !== index)
                    .map(favIndex => favIndex > index ? favIndex - 1 : favIndex);
                
                saveVocabulary();
                updateStats();
                renderWordLists();
                
                showNotification('Word deleted successfully', 'info');
            }
        }

        // Switch between tabs
        function switchTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === tabName) {
                    tab.classList.add('active');
                }
            });
            
            // Update active tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === tabName) {
                    content.classList.add('active');
                }
            });
            
            currentTab = tabName;
        }

        // Start a quiz
        function startQuiz() {
            // Hide word lists and show quiz
            document.querySelector('.right-column .card:first-child').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            document.getElementById('quiz-result').style.display = 'none';
            
            // Generate quiz questions
            generateQuizQuestions();
            
            // Reset quiz state
            quizData.active = true;
            quizData.currentQuestion = 0;
            quizData.score = 0;
            quizData.userAnswers = [];
            
            // Display first question
            displayQuestion();
            
            // Update streak if not already updated today
            updateStreak();
        }

        // Generate quiz questions from vocabulary
        function generateQuizQuestions() {
            quizData.questions = [];
            
            // Select up to 5 words for the quiz
            let quizWords = [...vocabulary];
            
            // Shuffle array
            quizWords = quizWords.sort(() => 0.5 - Math.random());
            
            // Take up to 5 words
            quizWords = quizWords.slice(0, Math.min(5, quizWords.length));
            
            // Create questions
            quizWords.forEach(word => {
                // Create wrong answers from other words
                let wrongAnswers = vocabulary
                    .filter(w => w.word !== word.word)
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 3)
                    .map(w => w.definition);
                
                // Combine with correct answer
                let allAnswers = [word.definition, ...wrongAnswers];
                
                // Shuffle answers
                allAnswers = allAnswers.sort(() => 0.5 - Math.random());
                
                // Find correct answer index
                const correctAnswerIndex = allAnswers.indexOf(word.definition);
                
                quizData.questions.push({
                    word: word.word,
                    definition: word.definition,
                    example: word.example,
                    answers: allAnswers,
                    correctAnswerIndex: correctAnswerIndex
                });
            });
        }

        // Display current question
        function displayQuestion() {
            if (!quizData.questions.length) {
                showNotification('Add more words to start a quiz!', 'warning');
                closeQuiz();
                return;
            }
            
            const question = quizData.questions[quizData.currentQuestion];
            const progress = `Question ${quizData.currentQuestion + 1} of ${quizData.questions.length}`;
            
            // Update progress
            document.getElementById('quiz-progress').textContent = progress;
            
            // Update question
            document.getElementById('quiz-question').textContent = `What is the meaning of the word "${question.word}"?`;
            
            // Update answer options
            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = '';
            
            question.answers.forEach((answer, index) => {
                const option = document.createElement('div');
                option.className = 'quiz-option';
                option.textContent = answer;
                option.setAttribute('data-index', index);
                
                // Check if user already answered this question
                if (quizData.userAnswers[quizData.currentQuestion] !== undefined) {
                    if (index === question.correctAnswerIndex) {
                        option.classList.add('correct');
                    } else if (index === quizData.userAnswers[quizData.currentQuestion]) {
                        option.classList.add('incorrect');
                    }
                }
                
                option.addEventListener('click', () => selectAnswer(index));
                optionsContainer.appendChild(option);
            });
            
            // Update buttons
            document.getElementById('quiz-prev-btn').style.display = quizData.currentQuestion > 0 ? 'inline-flex' : 'none';
            document.getElementById('quiz-next-btn').textContent = quizData.currentQuestion === quizData.questions.length - 1 ? 'Finish Quiz' : 'Next';
            document.getElementById('quiz-next-btn').innerHTML = quizData.currentQuestion === quizData.questions.length - 1 ? 
                'Finish Quiz <i class="fas fa-check"></i>' : 
                'Next <i class="fas fa-arrow-right"></i>';
            
            // Highlight selected answer if any
            if (quizData.userAnswers[quizData.currentQuestion] !== undefined) {
                const selectedOption = document.querySelector(`.quiz-option[data-index="${quizData.userAnswers[quizData.currentQuestion]}"]`);
                if (selectedOption && !selectedOption.classList.contains('correct')) {
                    selectedOption.classList.add('selected');
                }
            }
        }

        // Select an answer
        function selectAnswer(answerIndex) {
            // If already answered, don't allow changing
            if (quizData.userAnswers[quizData.currentQuestion] !== undefined) {
                return;
            }
            
            // Record user's answer
            quizData.userAnswers[quizData.currentQuestion] = answerIndex;
            
            // Check if answer is correct
            const question = quizData.questions[quizData.currentQuestion];
            const isCorrect = answerIndex === question.correctAnswerIndex;
            
            // Update score if correct
            if (isCorrect) {
                quizData.score++;
                
                // Update practice count for the word
                const wordIndex = vocabulary.findIndex(w => w.word === question.word);
                if (wordIndex !== -1) {
                    vocabulary[wordIndex].practiceCount++;
                    vocabulary[wordIndex].lastPracticed = new Date().toISOString();
                    saveVocabulary();
                }
            }
            
            // Show correct/incorrect styling
            const options = document.querySelectorAll('.quiz-option');
            options.forEach((option, index) => {
                option.classList.remove('selected');
                
                if (index === question.correctAnswerIndex) {
                    option.classList.add('correct');
                } else if (index === answerIndex && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });
            
            // Update stats after quiz completion if this is the last question
            if (quizData.currentQuestion === quizData.questions.length - 1) {
                setTimeout(showQuizResults, 1000);
            }
        }

        // Show next question
        function nextQuestion() {
            // If on last question, show results
            if (quizData.currentQuestion === quizData.questions.length - 1) {
                showQuizResults();
                return;
            }
            
            // Move to next question
            if (quizData.currentQuestion < quizData.questions.length - 1) {
                quizData.currentQuestion++;
                displayQuestion();
            }
        }

        // Show previous question
        function prevQuestion() {
            if (quizData.currentQuestion > 0) {
                quizData.currentQuestion--;
                displayQuestion();
            }
        }

        // Show quiz results
        function showQuizResults() {
            // Hide quiz, show results
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('quiz-result').style.display = 'block';
            
            // Calculate score percentage
            const scorePercentage = Math.round((quizData.score / quizData.questions.length) * 100);
            
            // Update stats
            stats.quizScore = scorePercentage;
            saveStats();
            updateStats();
            
            // Update result display
            document.getElementById('final-score').textContent = quizData.score;
            document.getElementById('total-questions').textContent = quizData.questions.length;
            
            const progressFill = document.getElementById('quiz-result-progress');
            progressFill.style.width = `${scorePercentage}%`;
            
            // Update result icon based on score
            const resultIcon = document.querySelector('.result-icon');
            resultIcon.className = 'result-icon ' + (scorePercentage >= 70 ? 'success' : 'warning');
            resultIcon.innerHTML = scorePercentage >= 70 ? 
                '<i class="fas fa-trophy"></i>' : 
                '<i class="fas fa-award"></i>';
        }

        // Close quiz and return to word list
        function closeQuiz() {
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('quiz-result').style.display = 'none';
            document.querySelector('.right-column .card:first-child').style.display = 'block';
            
            quizData.active = false;
        }

        // Update streak if user practiced today
        function updateStreak() {
            const today = new Date().toDateString();
            
            if (stats.lastPracticeDate !== today) {
                stats.streakDays++;
                stats.lastPracticeDate = today;
                saveStats();
                updateStats();
                
                if (stats.streakDays > 1) {
                    showNotification(`Practice streak: ${stats.streakDays} days!`, 'success');
                }
            }
        }

        // Check and reset streak if user missed a day
        function checkStreak() {
            const today = new Date();
            const lastPractice = stats.lastPracticeDate ? new Date(stats.lastPracticeDate) : null;
            
            if (lastPractice) {
                const diffTime = Math.abs(today - lastPractice);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                // If more than 1 day has passed, reset streak
                if (diffDays > 1) {
                    stats.streakDays = 0;
                    saveStats();
                    updateStats();
                }
            }
        }

        // Show notification
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <span>${message}</span>
                <button class="close-notification"><i class="fas fa-times"></i></button>
            `;
            
            // Add styles
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: ${type === 'success' ? '#10b981' : type === 'warning' ? '#f59e0b' : '#3b82f6'};
                color: white;
                padding: 15px 20px;
                border-radius: var(--radius);
                box-shadow: var(--shadow);
                display: flex;
                align-items: center;
                justify-content: space-between;
                min-width: 300px;
                z-index: 1000;
                animation: slideIn 0.3s ease-out;
            `;
            
            // Add close button event
            notification.querySelector('.close-notification').addEventListener('click', () => {
                notification.style.animation = 'slideOut 0.3s ease-out forwards';
                setTimeout(() => notification.remove(), 300);
            });
            
            // Add to page
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease-out forwards';
                    setTimeout(() => notification.remove(), 300);
                }
            }, 3000);
            
            // Add keyframe animations
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }
    </script>
</body>
</html>