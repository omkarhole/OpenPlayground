import { logger } from '../utils/logger.js';

export class WorldMap {
    constructor() {
        this.width = 60;
        this.height = 30;
        this.tiles = [];
        this.generate();
    }

    generate() {
        // Updated map with NPCs (O, M) and more features
        const mapIcon = [
            "############################################################",
            "#..........................................................#",
            "#....T.......#########......................S..............#",
            "#............#.......#.....................................#",
            "#......O.....#.......#.....................................#",
            "#............#.......#............###########..............#",
            "#............#.......#............#.........#..............#",
            "########.#####.......####.#########....M....#..............#",
            "#...........................................#.......T......#",
            "#...........................................#..............#",
            "#.....................@.....................#..............#",
            "#...........................................#..............#",
            "#......g....................................#..............#",
            "#...........................................#..............#",
            "########.############################.#######..............#",
            "#..........................................................#",
            "#..........................................................#",
            "#........................T.................................#",
            "#.........g................................................#",
            "#..........................................................#",
            "############################################################"
        ];

        this.tiles = mapIcon.map(row => row.split(''));
        this.height = this.tiles.length;
        this.width = this.tiles[0].length;
    }

    getTile(x, y) {
        if (x < 0 || x >= this.width || y < 0 || y >= this.height) {
            return '#'; // Out of bounds is a wall
        }
        return this.tiles[y][x];
    }

    setTile(x, y, char) {
        if (x >= 0 && x < this.width && y >= 0 && y < this.height) {
            this.tiles[y][x] = char;
        }
    }

    isBlocked(x, y) {
        const tile = this.getTile(x, y);
        return tile === '#' || tile === '~'; // Walls and water
    }
}
